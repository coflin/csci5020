<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Sneha Irukuvajjula</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="/static/assets/sneha-favicon-32x32.png" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="/static/css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand" href={{ MainPageRoute }}>Sneha</a>
                <button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href={{ ProjectRoute }}>Projects</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href={{ AboutRoute }}>About</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href= {{ ResumeRoute }}>Resume</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <br/><br/><br/><br/><br/>

        <center>
            <div class="projects-div">
                <h1 style="margin-left: 3%;color:#bd5d38;"> Personal NMAP using Scapy </h1>
                <br/><h5>Objective</h5>
                <p>
                    We're on a mission to figure out which ports are playing nice and open for us. TCP & UDP ports.
                </p>
                <br/><h5>Approach</h5>
                <p>
                    <i>Note: The first 1024 ports are a bit VIP or "well-known" ports, so we need to wear our "root" hats for scanning those.<br/></i>
                    Before diving straight to coding, let's figure out how to know if a port is open or not through scapy. First, I fired up Scapy on my command-line and ran this:
                    <br/><br/>
                    <img class="python-image" src="/static/assets/screen1.png">
                    <br/><br/>
                    100.64.26.1 is my own Linux VM which has just port 22 open. Our end goal is that our script should only report port 22 on my Linux VM as open.
                    We are sending a TCP Syn (<i>S</i>) flag to check if TCP is open on the given port or not. Basically, I am politely knocking on doors and checking
                    if someone is there to respond and open the door for me.
                    From the output, I see that it returns answered and unanswer-<i>ed</i> ports that didn't feel like chatting. Looking at it, my assumptionis that the talkative ones
                    are open and the unanswered ones are a no-go. Let's see if my assumption is right.
                    <br/><br/>
                    <img class="python-image" src="/static/assets/screen2.png">
                    <br/><br/>
                    Weird. All the ports answered to the TCP SYN flag I sent (<i>I can guarantee that only port 22 is open</i>). Probably, my assumption is not right.
                    Let's examine the headers for a few ports to see if I can differentiate between open and close ports.
                    <br/><br/>
                    <img class="python-image" src="/static/assets/screen3.png">
                    <br/><br/>
                    Closed ports were dropping <i>“RA”</i> flags instead of the expected <i>“SA”</i> for the <i>“S”</i> flag we sent. Expected a welcome mat, got a door slam.
                    Checked for port 22 (<i>which is supposed to be open</i>). 
                    <br/><br/>
                    <img class="python-image" src="/static/assets/screen4.png">
                    <br/><br/>
                    Aha! Port 22 responded with the “SA” flag. So, lesson learned – we can’t just assume; gotta peek at those flags to know what’s up.
                    So now we need to ensure that we actually check for the flags in the answered ports, that should help us figure out if a port is open.
                    Let’s see how we can extract the flags portion. We know answers is a list so I’ll just iterate through it. 
                    <br/><br/>
                    <img class="python-image" src="/static/assets/screen5.png">
                    <br/><br/>
                    Essentially, <i>str(answer[i][1]["TCP"].flags)</i> would extract the flag the destination port sent, where <i>"i"</i> contains the information of the port that answered.
                    Neat! Time for a coffee break.
                </p>


                <br/>
                <a href="https://github.com/coflin/csci5020/tree/main/assignment16" class="myButton">View Project on GitHub &nbsp;&nbsp;<i class="fab fa-fw fa-github" style="padding:5px;"></i></a>
                <br/><br/><br/><br/>
            </div>
        </center>
    
        <!-- Copyright Section-->
        <div class="copyright py-4 text-center text-white">
            <div class="container"><small>Copyright &copy; Sneha Irukuvajjula 2023</small></div>
        </div>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="/static/js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
   
    </body>
</html>